# BfoAnalysis

Приложение предназначено для скачивания отчетности компаний с bo.nalog.ru и помещения их в SQL. После чего по ним строятся графики и считаются некоторые статистические показатели.

Приложение после запуска имеет 3 режима:
1. `inn` - Скачиваются ИНН компаний из указанной пользователем отрасли (по номеру ОКВЭД2) и некоторая дополнительная информация, которую сразу предоставляет сайт. Это: название, огрн, регион и т.п. \
На этом этапе есть возможность посмотреть сколько компаний доступно для скачивания и указать их количество для загрузки. \
Данные загружаются в `data/data-okved-XX.db`
3. `data` - Для выбранных в `inn` компаний скачивается вся доступная на сайте отчетность (баланс, отчет о фин результатах и прочее). \
Также создается копия прошлой версии `data-okved-XX.db` и помещается в папку `copy`.
4. `plot` - по выбранной базе данных (указывается код ОКВЭД2) строятся графики и считаются статистические показатели, такие как:
   1. Мат ожидание
   2. Дисперсия
   3. Среднее квадратическое отклонение
   4. Асимметрия
   5. Эксцесс
   6. Медиана
   7. Межквартальный размах \

Графики сохраняются в `plots`, статистика - в `stat`

При построении графиков в файле `drawPlots.txt` указываются все настройки и сами графики. \
В части `config:` прописываются сокращения. По типу `B = balance`, а `c = current`.
Сокращения большими буквами всегда воспринимаются как названия таблицы из которой подгружаются данные. Маленькие - нужны для сокращения наименования колонок. Такая сложная система существует поскольку в оригинале все это записывается как `balance.current1100` для строки баланса 1100. Можно было бы, конечно, просто автоматически подгружать данные из нужной таблицы, смотря на номер строки, но ладно уж. Будет пока как есть.

Далее - в каждом графике можно задать следующие параметры:

- `name:` Название графика
- `period:` Год, за который берутся данные. Чтобы взять 2 года нужно написать `period: 2024 or 2025`
- `nameX:` и `nameY:` Подписи соответствующих осей
- `xlim:` и `ylim:` Ограничить график по осям. Пишется как `xlim: -10 10.5`
- `parms:` Обширная штука. Позволяет задать множество разных настроек (указываются через пробел):

  - `DIS` - исключить повторяющиеся значения
  - `LOGx` и `LOGy` - логарифмирует значения по соответствующей оси
  - `symLOGx` и `symLOGy` - логарифмирует значения по соответствующей оси с учетом отрицательных значений. Плохо, что стандартная функция не позволяет просто сделать логарифм отрицательным, поэтому возле 0 ось становится линейной.
  - `STAT` - по значениям y графика будут рассчитываться статистические показатели
  - `NON` - (No None) - исключает пустые значения
- `sortBy:` Укажите строки или уравнения, по которым будет идти сортировка и будет ли она по возрастанию `ASC` или по убыванию `DESC`. Вот пример: `sortBy: B.c1100 + B.c1200 ASC`
- `y:` и `x:` Непосредственно те уравнения, по которым будут строиться графики. Не обязательно прописывать уравнения для обоих осей. Можно указать только 1 и тогда по второй автоматически построится ряд значений \[1,2,4,...\]. \
Пример: `y: B.c1310 / B.c1600, F.c2100 / B.c1100` \
(Из-за особенностей SQL пока что во всех операциях нужно ставить пробелы между +, -, /, *).\
Данный код практически напрямую подставляется в функцию SELECT, поэтому можно использовать стандартные для sqlite функции по типу `POWER(B.c1100, 2)`.
- `legend:` Можно указать подписи для выборки от каждого применяемого уравнения

Пример заполнения файла в `exampleOfDrawPlots.txt`